# UI-001: 履歴一覧ダイアログ（検索/コピー/再貼り付け導線）

## メタ情報

| 項目 | 内容 |
|:---|:---|
| イシューID | UI-001 |
| ステータス | ✅ 完了 |
| 優先度 | P2 🟡 Medium |
| 作成日 | 2025-12-16 |
| 更新日 | 2025-12-16 |
| 完了日 | 2025-12-16 |
| 担当者 | - |
| 関連イシュー | [HIST-001](./HIST-001_transcription_history_store_last_50.md), [SYNC-001](./SYNC-001_integration_wizard_history_settings.md) |

---

## 1. 背景・目的

履歴50件を保持しても、取り出しUIが弱いと初心者は使えない。
「探す→確認→コピー→貼り付け」が迷わずできる画面を提供する。

---

## 2. 現状の問題点

- 現状は「最後の結果」しか確認できない
- コピー導線はあるが、複数履歴からの選択ができない

---

## 3. 実装方針

- `HistoryDialog` を追加し、一覧（テーブル/リスト）で履歴を表示
- 右クリックメニューとトレイメニューに「History...」を追加
- 既存の `Show Last Result...` は残す（最短導線）

---

## 4. 具体的な要件

### A. 表示要素

- 一覧
  - 日時
  - provider
  - 先頭プレビュー（1行）
  - エラーの有無
- 詳細
  - クリックで全文表示（右ペイン or 下部）

### B. 操作

- `Copy` ボタン（全文コピー）
- `Paste` ボタン（任意）
  - 既存の自動貼り付けの仕組みを利用（Ctrl+V）
  - Wayland等で失敗する場合は案内
- `Search`（任意）
  - 文字列フィルタ（部分一致）

### C. 性能

- 対象は最大50件のため、実装はシンプルで良い

---

## 5. 挙動シナリオ（ユースケース）

| シチュエーション | 期待する挙動 |
|:---|:---|
| 貼り付け失敗 | Historyから該当結果を選んでCopyできる |
| 過去のメモを再利用 | すぐに探してコピーできる |

---

## 6. テストケース

| ID | シナリオ | 手順 | 期待結果 |
|:---|:---|:---|:---|
| TC-01 | 一覧表示 | 履歴が10件ある状態で開く | 10件表示される |
| TC-02 | コピー | 1件選択→Copy | クリップボードに全文が入る |
| TC-03 | エラー表示 | error付き履歴がある | エラー行が分かる表示になる |

---

## 7. 影響範囲

| 領域 | 影響内容 | 対策 |
|:---|:---|:---|
| メニュー | トレイ/右クリックに追加 | 既存項目は維持 |
| 履歴読み込み | HIST-001のAPI利用 | UIは読み込み専用にする |

---

## 8. 懸念点・確認事項

- [x] UI部品（`QTableWidget` を採用）
- [ ] `Paste` 機能の要否（初心者はCopyして貼り付けの方が確実なケースあり）

---

## 9. 実装完了項目

- [x] HistoryDialog 実装
- [x] メニュー追加（右クリック/トレイに `History...`）
- [x] Copy導線
- [x] 表示/操作の回帰確認
